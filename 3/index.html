<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS180 Project 3: Face Morphing - Adnan Aman</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
    <style>
        .bg-dark-section {
            background-color: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .equation {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .gif-container {
            width: 70%;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <header class="text-center mb-5">
            <h1>CS180 Project 3: Face Morphing</h1>
            <h2>Adnan Aman</h2>
        </header>

        <section class="bg-dark-section">
            <h2>Project Overview</h2>
            <p>In this project, I worked on face morphing, computing average faces, and creating caricatures. I
                implemented different image processing techniques to morph one face into another, calculate the mean
                face from a group of faces, and make exaggerated versions of faces.</p>
        </section>

        <section class="bg-dark-section">
            <h2>Part 1: Defining Correspondences</h2>
            <p>For the correspondences, I used the tool from a previous student's project (available <a
                    href="https://cal-cs180.github.io/fa23/hw/proj3/tool.html" target="_blank">here</a>). I selected
                images of Conor McGregor and Lionel Messi from <a href="https://martinschoeller.com/"
                    target="_blank">Martin Schoeller's close-up series</a>. I then hand-picked the correspondences,
                making sure I had enough points for a good warp and a good number of triangles.</p>
            <div class="row">
                <div class="col-md-4">
                    <img src="images/mcgregor_delaunay.png" class="img-fluid"
                        alt="McGregor's face with Delaunay triangulation">
                    <p class="text-center">McGregor with Delaunay triangulation</p>
                </div>
                <div class="col-md-4">
                    <img src="images/messi_delaunay.png" class="img-fluid"
                        alt="Messi's face with Delaunay triangulation">
                    <p class="text-center">Messi with Delaunay triangulation</p>
                </div>
                <div class="col-md-4">
                    <img src="images/adnan_delaunay.png" class="img-fluid"
                        alt="Adnan's face with Delaunay triangulation">
                    <p class="text-center">My face with Delaunay triangulation</p>
                </div>
            </div>
        </section>

        <section class="bg-dark-section">
            <h2>Part 2: Computing the "Mid-way Face"</h2>
            <p>To create the mid-way face between McGregor and Messi, I followed these steps:</p>
            <ol>
                <li>Computed the average shape by averaging the corresponding points from both images.</li>
                <li>For each triangle in the original images and the average shape, I calculated an affine
                    transformation matrix.</li>
                <li>Using these matrices, I performed inverse warping to map pixels from the original images to the
                    average shape.</li>
                <li>I used polygon masking to ensure only relevant pixels were warped.</li>
                <li>Finally, I cross-dissolved the two warped images by averaging their pixel values to create the
                    mid-way face.</li>
            </ol>
            <div class="row">
                <div class="col-md-4">
                    <img src="images/mcgregor.jpg" class="img-fluid" alt="Original McGregor">
                    <p class="text-center">Original McGregor</p>
                </div>
                <div class="col-md-4">
                    <img src="images/midway_face.jpg" class="img-fluid" alt="Midway Face">
                    <p class="text-center">Midway Face</p>
                </div>
                <div class="col-md-4">
                    <img src="images/messi.jpg" class="img-fluid" alt="Original Messi">
                    <p class="text-center">Original Messi</p>
                </div>
            </div>
        </section>

        <section class="bg-dark-section">
            <h2>Part 3: The Morph Sequence</h2>
            <p>I created a morph sequence by generating 45 frames. For each frame, I linearly interpolated the warp_frac
                and dissolve_frac from 0 to 1. I then created the morphed image for each frame using these interpolated
                values. Finally, I saved the frames together as an animated GIF.</p>
            <div class="gif-container text-center">
                <img src="images/mcmessi_morph_sequence.gif" alt="Morph Sequence GIF" class="img-fluid" id="morphGif">
                <p class="text-center">Morph Sequence: McGregor to Messi</p>
                <button class="btn btn-primary mt-2"
                    onclick="document.getElementById('morphGif').src = document.getElementById('morphGif').src">Replay</button>
            </div>
        </section>

        <section class="bg-dark-section">
            <h2>Part 4: The "Mean Face" of a Population</h2>
            <p>For this part, I used the <a href="https://fei.edu.br/~cet/facedatabase.html" target="_blank">FEI Face
                    Database</a>. I clipped some points that were going outside of the image range. I then chose one
                image to warp to the average face (and vice versa), as well as doing it on my own face after choosing
                corresponding points.</p>
            <div class="row">
                <div class="col-md-3">
                    <img src="images/mean_neutral_face.jpg" class="img-fluid" alt="Mean Neutral Face">
                    <p class="text-center">Mean Neutral Face</p>
                </div>
                <div class="col-md-3">
                    <img src="images/mean_smiling_face.jpg" class="img-fluid" alt="Mean Smiling Face">
                    <p class="text-center">Mean Smiling Face</p>
                </div>
                <div class="col-md-3">
                    <img src="images/dataset_face.jpg" class="img-fluid" alt="Original Dataset Face">
                    <p class="text-center">Original Dataset Face</p>
                </div>
                <div class="col-md-3">
                    <img src="images/warped_dataset_to_neutral.jpg" class="img-fluid"
                        alt="Dataset Face Warped to Neutral Shape">
                    <p class="text-center">Dataset Face Warped to Neutral Shape</p>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-4">
                    <img src="images/normalface.png" class="img-fluid" alt="My Normal Face">
                    <p class="text-center">My Normal Face</p>
                </div>
                <div class="col-md-4">
                    <img src="images/adnan_warped_to_neutral.jpg" class="img-fluid"
                        alt="My Face Warped to Neutral Shape">
                    <p class="text-center">My Face Warped to Neutral Shape</p>
                </div>
                <div class="col-md-4">
                    <img src="images/neutral_warped_to_adnan.jpg" class="img-fluid"
                        alt="Neutral Face Warped to My Shape">
                    <p class="text-center">Neutral Face Warped to My Shape</p>
                </div>
            </div>
        </section>

        <section class="bg-dark-section">
            <h2>Part 5: Caricatures - Extrapolating from the Mean</h2>
            <p>I used different alpha values to create caricatures by extrapolating from the mean. The caricature points
                were calculated using this formula:</p>
            <div class="equation" id="caricature-equation"></div>
            <script>
                katex.render("\\text{caricature_points} = \\alpha \\cdot \\text{mean_neutral_points} + (1 - \\alpha) \\cdot \\text{adnan_points}", document.getElementById("caricature-equation"));
            </script>
            <div class="row">
                <div class="col-md-4">
                    <img src="images/caricature_adnan_alpha_-2.00.jpg" class="img-fluid"
                        alt="Caricature (alpha = -2.00)">
                    <p class="text-center">Caricature (α = -2.00)</p>
                </div>
                <div class="col-md-4">
                    <img src="images/caricature_adnan_alpha_-0.50.jpg" class="img-fluid"
                        alt="Caricature (alpha = -0.50)">
                    <p class="text-center">Caricature (α = -0.50)</p>
                </div>
                <div class="col-md-4">
                    <img src="images/caricature_adnan_alpha_2.00.jpg" class="img-fluid" alt="Caricature (alpha = 2.00)">
                    <p class="text-center">Caricature (α = 2.00)</p>
                </div>
            </div>
        </section>

        <section class="bg-dark-section">
            <h2>Bells & Whistles</h2>
            <p>I computed the eigenfaces by performing PCA on the dataset. Here are the top 16 principal components:</p>
            <div class="text-center">
                <img src="images/eigenfaces_plot.png" class="img-fluid" alt="Eigenfaces Plot">
                <p class="text-center">Eigenfaces Plot (Top 16)</p>
            </div>
            <p>I then used these eigenfaces along with some of the neutral normal faces to produce caricatures by adding
                a random variable alpha. Here are the results:</p>
            <div class="row">
                <div class="col-md-3">
                    <img src="images/original_face_1.jpg" class="img-fluid" alt="Original Face 1">
                    <p class="text-center">Original Face 1</p>
                </div>
                <div class="col-md-3">
                    <img src="images/caricature_face_1.jpg" class="img-fluid" alt="Caricature Face 1">
                    <p class="text-center">Caricature Face 1</p>
                </div>
                <div class="col-md-3">
                    <img src="images/original_face_2.jpg" class="img-fluid" alt="Original Face 2">
                    <p class="text-center">Original Face 2</p>
                </div>
                <div class="col-md-3">
                    <img src="images/caricature_face_2.jpg" class="img-fluid" alt="Caricature Face 2">
                    <p class="text-center">Caricature Face 2</p>
                </div>
            </div>
        </section>

        <section class="bg-dark-section">
            <h2>Conclusion</h2>
            <p>This project demonstrated the power of image processing techniques in face morphing, average face
                computation, and caricature generation. Through the implementation of various algorithms, it's possible
                to create seamless transitions between faces, compute population averages, and exaggerated facial
                features for caricatures.</p>
        </section>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>